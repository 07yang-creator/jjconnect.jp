# Admin Dashboard å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸš€ å¿«é€Ÿæµ‹è¯•

### æ–¹æ³• 1: ä½¿ç”¨æµ‹è¯•é¡µé¢ï¼ˆæ¨èï¼‰

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `admin-test.html`
2. é€‰æ‹©è¦æµ‹è¯•çš„è§’è‰²ï¼ˆç®¡ç†å‘˜/ç¼–è¾‘è€…/è®¿å®¢ï¼‰
3. ç‚¹å‡»"æ‰“å¼€ Admin Dashboard"æŒ‰é’®
4. è§‚å¯Ÿä¸åŒè§’è‰²çš„æƒé™å·®å¼‚

### æ–¹æ³• 2: ç›´æ¥ä¿®æ”¹ä»£ç 

åœ¨ `admin.html` ä¸­æ‰¾åˆ°è¿™ä¸€è¡Œï¼š

```javascript
let userRole = 2; // ä¿®æ”¹ä¸º 0, 1, æˆ– 2
```

- `0` = Viewer (è®¿å®¢) - åªè¯»æƒé™
- `1` = Editor (ç¼–è¾‘è€…) - å¯ç¼–è¾‘ï¼Œä¸å¯åˆ é™¤
- `2` = Admin (ç®¡ç†å‘˜) - å®Œå…¨æƒé™

### æ–¹æ³• 3: ä½¿ç”¨è°ƒè¯•é¢æ¿

1. æ‰“å¼€ `admin.html`
2. åœ¨é¡µé¢å³ä¸‹è§’æ‰¾åˆ°"ğŸ”§ å¼€å‘è€…è°ƒè¯•é¢æ¿"
3. ä½¿ç”¨ä¸‹æ‹‰èœå•å®æ—¶åˆ‡æ¢è§’è‰²
4. è§‚å¯Ÿé¡µé¢ UI çš„åŠ¨æ€å˜åŒ–

## ğŸ“‹ æƒé™å¯¹ç…§è¡¨

| åŠŸèƒ½ | Viewer | Editor | Admin |
|------|--------|--------|-------|
| æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨ | âœ… | âœ… | âœ… |
| æ·»åŠ ç”¨æˆ· | âŒ | âŒ | âœ… |
| ç¼–è¾‘ç”¨æˆ· | âŒ | âœ… | âœ… |
| åˆ é™¤ç”¨æˆ· | âŒ | âŒ | âœ… |
| å‘å¸ƒå†…å®¹ | âŒ | âœ… | âœ… |
| ç¼–è¾‘å†…å®¹ | âŒ | âœ… | âœ… |
| åˆ é™¤å†…å®¹ | âŒ | âŒ | âœ… |
| ç³»ç»Ÿè®¾ç½® | âŒ | âŒ | âœ… |

## ğŸ”Œ Cloudflare Workers é›†æˆ

### æ­¥éª¤ 1: åˆ›å»ºè®¤è¯ç«¯ç‚¹

åœ¨æ‚¨çš„ Cloudflare Workers ä¸­åˆ›å»º `/api/auth/check` ç«¯ç‚¹ï¼š

```javascript
export default {
  async fetch(request) {
    // éªŒè¯ç”¨æˆ·ä¼šè¯
    const session = await validateSession(request);
    
    return new Response(JSON.stringify({
      authenticated: true,
      role: 2, // 0=Viewer, 1=Editor, 2=Admin
      username: "admin_user",
      email: "admin@jjconnect.jp"
    }), {
      headers: { 'Content-Type': 'application/json' }
    });
  }
};
```

### æ­¥éª¤ 2: åœ¨ admin.html ä¸­å¯ç”¨é›†æˆ

1. æ‰“å¼€ `admin.html`
2. æ‰¾åˆ° `checkAuth()` å‡½æ•°
3. å–æ¶ˆæ³¨é‡Š `fetch()` è°ƒç”¨éƒ¨åˆ†
4. æ›¿æ¢ API endpoint ä¸ºæ‚¨çš„å®é™…åœ°å€ï¼š

```javascript
const CLOUDFLARE_AUTH_ENDPOINT = 'https://your-worker.your-subdomain.workers.dev/api/auth/check';
```

### æ­¥éª¤ 3: æµ‹è¯•é›†æˆ

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. è®¿é—® `admin.html`
3. æŸ¥çœ‹ Network æ ‡ç­¾ï¼Œç¡®è®¤ API è°ƒç”¨æˆåŠŸ
4. æŸ¥çœ‹ Console æ ‡ç­¾ï¼Œç¡®è®¤è§’è‰²æ­£ç¡®è®¾ç½®

## ğŸ›¡ï¸ å®‰å…¨æç¤º

âš ï¸ **é‡è¦ï¼š** å‰ç«¯æƒé™æ§åˆ¶åªæ˜¯ UI å±‚é¢çš„ä¿æŠ¤ï¼

çœŸæ­£çš„æƒé™éªŒè¯å¿…é¡»åœ¨åç«¯ï¼ˆCloudflare Workersï¼‰è¿›è¡Œï¼š

```javascript
// åç«¯ç¤ºä¾‹ï¼šéªŒè¯ç”¨æˆ·æƒé™
async function deleteUser(userId, userRole) {
  // âœ… æ­£ç¡®ï¼šåœ¨åç«¯éªŒè¯æƒé™
  if (userRole < 2) {
    return new Response('Permission denied', { status: 403 });
  }
  
  // æ‰§è¡Œåˆ é™¤æ“ä½œ
  await db.users.delete(userId);
  return new Response('User deleted', { status: 200 });
}
```

## ğŸ“ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ¸…å•

éƒ¨ç½²å‰è¯·å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼š

- [ ] åˆ é™¤å³ä¸‹è§’çš„è°ƒè¯•é¢æ¿ä»£ç 
- [ ] å¯ç”¨ `checkAuth()` çš„å®é™… API è°ƒç”¨
- [ ] æ›¿æ¢æ‰€æœ‰ `/api/*` ä¸ºå®é™…çš„ Cloudflare Workers URL
- [ ] è®¾ç½®é»˜è®¤ `userRole = 0`ï¼ˆæœ€ä½æƒé™ï¼‰
- [ ] å¯ç”¨æœªè®¤è¯æ—¶çš„ç™»å½•é¡µé¢é‡å®šå‘
- [ ] é…ç½® CORS headers
- [ ] æµ‹è¯•æ‰€æœ‰è§’è‰²çš„æƒé™æ§åˆ¶
- [ ] åœ¨åç«¯å®ç°çœŸæ­£çš„æƒé™éªŒè¯

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæƒé™æ§åˆ¶ä¸ç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
2. æ£€æŸ¥æ˜¯å¦æœ‰ JavaScript é”™è¯¯
3. ç¡®è®¤ `userRole` å˜é‡å€¼æ˜¯å¦æ­£ç¡®
4. ç¡®è®¤ `applyPermissionControls()` æ˜¯å¦è¢«è°ƒç”¨

### é—®é¢˜ï¼šæ— æ³•åˆ‡æ¢è§’è‰²

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤è°ƒè¯•é¢æ¿æ˜¯å¦å¯è§
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ localStorage
3. åˆ·æ–°é¡µé¢é‡è¯•

### é—®é¢˜ï¼šCloudflare Workers é›†æˆå¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ API endpoint URL æ˜¯å¦æ­£ç¡®
2. æŸ¥çœ‹ Network æ ‡ç­¾ç¡®è®¤è¯·æ±‚çŠ¶æ€
3. æ£€æŸ¥ CORS é…ç½®
4. ç¡®è®¤åç«¯è¿”å›çš„ JSON æ ¼å¼æ­£ç¡®

## ğŸ“š æ›´å¤šèµ„æº

- **å®Œæ•´æ–‡æ¡£**: `ADMIN_PERMISSIONS_README.md`
- **æµ‹è¯•é¡µé¢**: `admin-test.html`
- **ç®¡ç†åå°**: `admin.html`
- **ç™»å½•é¡µé¢**: `login.html`

## ğŸ’¬ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
- æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—
- `admin.html` ä¸­çš„è¯¦ç»†æ³¨é‡Š
- `ADMIN_PERMISSIONS_README.md` å®Œæ•´æ–‡æ¡£

---

**å¿«é€Ÿé“¾æ¥:**
- [æ‰“å¼€æµ‹è¯•é¡µé¢](admin-test.html)
- [æ‰“å¼€ç®¡ç†åå°](admin.html)
- [æŸ¥çœ‹å®Œæ•´æ–‡æ¡£](ADMIN_PERMISSIONS_README.md)
